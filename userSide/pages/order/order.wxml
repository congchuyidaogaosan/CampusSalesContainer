<view class="container">
  <view class="order-list">
    <view class="order-item" wx:for="{{orders}}" wx:key="orderId">
      <view class="order-header">
        <text class="order-number">订单号：{{item.orderNumber}}</text>
        <text class="order-status {{item.statusClass}}">{{item.payStatus}}</text>
      </view>

      <view class="order-info">
        <view class="info-row">
          <text class="label">下单时间：</text>
          <text>{{item.orderTime}}</text>
        </view>
        <view class="info-row">
          <text class="label">订单金额：</text>
          <text class="amount">¥{{item.orderAmount}}</text>
        </view>
        <view class="info-row">
          <text class="label">售货柜ID：</text>
          <text>{{item.machineId}}</text>
        </view>
      </view>

      <view class="order-actions">
        <block wx:if="{{item.payStatus === '未支付'}}">
          <button class="action-btn primary" bindtap="repurchase" data-id="{{item.orderId}}">去支付</button>
          <button class="action-btn" bindtap="cancelOrder" data-id="{{item.orderId}}">取消订单</button>
        </block>
        <block wx:else>
          <button class="action-btn" bindtap="repurchase" data-id="{{item.orderId}}">再次购买</button>
        </block>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{orders.length === 0 && !loading}}">
    <text>暂无订单</text>
  </view>
</view>

<wxs module="utils">
module.exports = {
  formatPrice: function(price) {
    return parseFloat(price).toFixed(2)
  }
}
</wxs> 